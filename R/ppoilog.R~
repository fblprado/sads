ppoilog <- function(q, mu, sig, lower.tail=TRUE, log.p=FALSE, trunc=NULL){
  if(!is.null(trunc){
    if(any(q<=trunc))stop("at least one q larger than truncation value")
    f1 <- function(n,mu,sig){
      dpoilog(n,mu,sig)/(1-sum(dpoilog(0:trunc,mu,sig)))
      }
    ifelse(lower.tail, y <- sum(f1((trunc+1):q,N,alpha)), y <- 1-sum(f1((trunc+1):q,N,alpha)))
  }
  else ifelse(lower.tail, y <- sum(dpoilog(0:q,N,alpha)), y <- 1-sum(dls(1:q,N,alpha)))
  ifelse(log.p, log(y), y)
}
